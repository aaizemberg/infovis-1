<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>INFOVIS | TP2</title>
</head>
<body>
  
  
 <script src="https://code.jquery.com/jquery-2.1.4.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.min.js"></script>
 <script src="dataset.json"></script>

<script>

function yPos(d,i){return 60+i*60;}

var svg = d3.select("body").append("svg")
  .attr("width", 1000)
  .attr("height", 1000);


svg.selectAll("text")
   .data(dataset)
   .enter()
   .append("text")
   .attr("x", 10)
   .attr("y", function (d,i){return 70+i*60;})
   .attr("height", 30)
   .text(function(d,i){return d.text;});

var green = '#5cb85c';
var yellow = '#f0ad4e';
var red = '#c9302c';

var scalar = 4;

var retrievers = [];
  retrievers[0] = function (d,i){return scalar * d.agree;};
  retrievers[1] = function (d,i){return scalar * d.neutral;};
  retrievers[2] = function (d,i){return scalar * d.desagree;};

function renderColumn(data, color, offset, className, retriever){
  //bind data
  var rects = svg.selectAll("."+className).data(data);

  //enter
  rects.enter().append("rect");

  //update
  rects.attr("x", offset)
   .attr("y", yPos)
   .attr("width", retriever)
   .attr("height", 30)
   .attr("fill", color);
}

var offset = 300;

renderColumn(dataset, green, function(d,i){return offset;}, 'agree',retrievers[0]);

renderColumn(dataset, yellow, function(d,i){return offset+retrievers[0](d,i);}, 'neutral',retrievers[1]);

renderColumn(dataset, red, function(d,i){return offset+retrievers[0](d,i)+retrievers[1](d,i);}, 'desagree',retrievers[2]);


</script>
</body>
</html>
